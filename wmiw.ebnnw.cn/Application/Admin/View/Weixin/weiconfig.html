<include file="Common:meta" />
<title>添加/编辑链接-{$site.SITE_INFO.name}</title>
<meta name="description" content="{$site.SITE_INFO.keyword}">
<meta name="keywords" content="{$site.SITE_INFO.description}">
<include file="Common:link" />
<body data-type="widgets">
    <div class="am-g tpl-g">
        <!-- 头部 -->
        <include file="Common:header" />
        <!-- 内容区域 -->
        <div class="tpl-content-wrapper">
            <div class="row-content am-cf">
                <div class="row">
                    <div class="am-u-sm-12 am-u-md-12 am-u-lg-12">
                        <div class="widget am-cf">
                            <div class="widget-head am-cf">
                                <div class="widget-title am-fl">添加/编辑链接</div>
                            </div>

                            <div class="widget-body am-fr">
                                <form id="rechargeableForm" class="am-form tpl-form-border-form tpl-form-border-br">
                                    <div class="widget-sun-head">公众号开发信息</div>
                                    <div class="am-form-group">
                                        <label for="appidappid" class="am-u-sm-3 am-form-label">开发者ID(AppID)</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[appid]" value="{$weixin.appid}"  placeholder="请输入appid">
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">开发者密码(AppSecret)</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[appsecret]" value="{$weixin.appsecret}" placeholder="请输入AppSecret">
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">IP白名单</label>
                                        <div class="am-u-sm-9 input-txt-lin am-cf">
                                            <div class="on-txt">将本站所在【服务器的IP地址】添加至微信公众平台【开发者信息】的IP白名单中</div>
                                        </div>
                                    </div>
                                    <div class="widget-sun-head">服务器配置</div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">服务器地址(URL)</label>
                                        <div class="am-u-sm-9">
                                            <small>{$weixin.url}</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">令牌(Token)</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[token]" value="{$weixin.token}" placeholder="请输入Token">
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">消息加解密密钥(EncodingAESKey)</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[encodingaeskey]" value="{$weixin.encodingaeskey}" placeholder="请输入EncodingAESKey">
                                        </div>
                                    </div>
                                    <div class="widget-sun-head">公众号自动回复</div>
                                    <div class="am-form-group">
                                        <label for="reply_follow" class="am-u-sm-3 am-form-label">关注公众号回复</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[reply_follow]" value="{$weixin.reply_follow}"  placeholder="请输入关注公众号回复">
                                            <small>用户关注公众后自动发送</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="reply_defaule" class="am-u-sm-3 am-form-label">关键词默认回复</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[reply_defaule]" value="{$weixin.reply_defaule}" placeholder="请输入关键词默认回复">
                                            <small>用户发送关键词后系统没有找到对应消息时候的默认回复</small>
                                        </div>
                                    </div>
                                    <div class="widget-sun-head">微信登录模式</div>
                                    <div class="am-form-group">
                                        <label for="rec" class="am-u-sm-3 am-form-label">绑定PC版账号</label>
                                        <div class="am-u-sm-9">
                                            <label class="am-checkbox am-secondary">
                                                <input type="radio" name="Weixin[diversity]" value="1" data-am-ucheck <eq name="weixin.diversity" value="1">checked</eq> /> 是 微信进入网站时显示登录、注册页面，可选择绑定PC版账号、自动登录、公众号提醒
                                            </label>
                                            <label class="am-checkbox am-secondary">
                                                <input type="radio" name="Weixin[diversity]" value="0" data-am-ucheck <eq name="weixin.diversity" value="0">checked</eq> /> 否 微信进入网站时不显示登录、注册页面，直接进行登录或自动生成账号登录
                                            </label>
                                            <small>微信授权模式为snsapi_userinfo （未关注公众账号的人点击用户分享的链接会进入授权登陆页面，授权登陆后直接跳转到所分享的页面）</small>
                                        </div>
                                        
                                    </div>
                                    <div class="am-form-group">
                                        <label for="rec" class="am-u-sm-3 am-form-label">公众号二维码弹窗</label>
                                        <div class="am-u-sm-9">
                                            <div class="am-cf">
                                                <label class="am-checkbox am-secondary am-margin-right-sm am-fl">
                                                    <input type="radio" value="1" name="Weixin[codemap]" data-am-ucheck <eq name="weixin.codemap" value="1">checked="checked"</eq>/> 开启
                                                </label>
                                                <label class="am-checkbox am-secondary am-fl">
                                                    <input type="radio" value="0" name="Weixin[codemap]" data-am-ucheck <eq name="weixin.codemap" value="0">checked="checked"</eq> /> 关闭 
                                                </label>
                                            </div>
                                            <small>（未关注公众号用户点击朋友圈分享的网站链接授权登陆后，浏览网页时候会以弹窗显示二维码方式提醒用户关注公众号！）</small>
                                            <div class="uploadePic-box am-margin-bottom-0 am-cf">
                                                <ul  data-am-widget="gallery" data-am-gallery="{pureview:{target: 'a.showurl'}}">
                                                    <notempty name="weixin.codemapimg">
                                                        <li class="img-box">
                                                            <div class="upImg-list-box am-gallery-item">
                                                                <a class="showurl" href="{:C('UPLOADS_PICPATH')}{$weixin.codemapimg}" ><img src="{:C('UPLOADS_PICPATH')}{$weixin.codemapimg}"><input type="hidden" name="Weixin[codemapimg]" value="{$weixin.codemapimg}" /></a>
                                                            </div>
                                                        </li>
                                                    </notempty>
                                                    <li class="upImg-lighthouse">
                                                        <div class="upImg-list-box">
                                                            <div class="filePic">
                                                                <i class="am-icon-cloud-upload"></i><div class="txt">上传图片</div>
                                                                <input type="file" pname="Weixin[codemapimg]" link="{:U('Upload/upCodemapPic')}" class="upInput" value="选择凭证图片" name="file" max="5" maxsize="5120" allowexts="gif,jpeg,jpg,png,bmp" accept="image/*" multiple>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                            <small>图片尺寸：正方形图片</small>
                                        </div>
                                    </div>
                                    <div class="widget-sun-head">微信模板消息ID配置</div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">设置教程</label>
                                        <div class="am-u-sm-9">
                                            <small>进入微信公众平台【功能】->【消息模板】(如果没有消息模板选择添加功能插件获得该功能) 消息模板所在行业为：IT科技 互联网|电子商务<br/>
                                    1.在【模板库】内搜索下方模板名称，对比模板库编号找到对应模板，点击[详情]后进入详情页面点击[添加]<br/>
                                    2.在【我的模板】内找到添加的模板，复制模板ID到下方对应位置</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">出价成功通知-模板ID</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[template][bidsuccess]" value="{$weixin.template.bidsuccess}" placeholder="请输入模板ID">
                                            <small>（模板库编号：OPENTM400094089）</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">竞拍价格被超越通知-模板ID</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[template][surpass]" value="{$weixin.template.surpass}" placeholder="请输入模板ID">
                                            <small>（模板库编号：OPENTM406437454）</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">拍卖状态改变提醒-模板ID</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[template][bidstatus]" value="{$weixin.template.bidstatus}"placeholder="请输入模板ID">
                                            <small>（模板库编号：OPENTM206927467）</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">竞拍成功通知-模板ID</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[template][success]" value="{$weixin.template.success}"placeholder="请输入模板ID">
                                            <small>（模板库编号：OPENTM202440123）</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">订单状态提醒-模板ID</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[template][orderstatus]" value="{$weixin.template.orderstatus}"placeholder="请输入模板ID">
                                            <small>（模板库编号：OPENTM405955935）</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">账户余额变动通知-模板ID</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[template][walletchange]" value="{$weixin.template.walletchange}"placeholder="请输入模板ID">
                                            <small>（模板库编号：OPENTM205454780）</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">拍品上架通知-模板ID</label>
                                        <div class="am-u-sm-9">
                                            <input type="text" class="tpl-form-input" name="Weixin[template][addsuccess]" value="{$weixin.template.addsuccess}"placeholder="请输入模板ID">
                                            <small>（模板库编号：OPENTM207294943）</small>
                                        </div>
                                    </div>
                                    <div class="widget-sun-head">微信分享配置</div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">分享朋友圈赠送</label>
                                        <div class="am-u-sm-9 input-txt-lin am-cf">
                                            <div class="on-txt">用户每分享一次赠送</div><input type="text" class="on-txt" name="Weixin[giveintegral]" value="{$weixin.giveintegral}"/>
                                            <div class="on-txt">元信誉额度；每天最多获得</div><input type="text" class="on-txt" name="Weixin[limitday]" value="{$weixin.limitday}"/><div class="on-txt">次奖励；永久最多获取</div><input type="text" class="on-txt" name="Weixin[limitlife]" value="{$weixin.limitlife}"/><div class="on-txt">次奖励（为空或者0则不限制上限）。</div>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="appsecret" class="am-u-sm-3 am-form-label">分享链接默认图片</label>
                                        <div class="am-u-sm-9">
                                            <div class="uploadePic-box am-margin-bottom-0 am-cf">
                                                <ul  data-am-widget="gallery" data-am-gallery="{pureview:{target: 'a.showurl'}}">
                                                    <notempty name="weixin.shareimg">
                                                        <li class="img-box">
                                                            <div class="upImg-list-box am-gallery-item">
                                                                <a class="showurl" href="{:C('UPLOADS_PICPATH')}{$weixin.shareimg}" ><img src="{:C('UPLOADS_PICPATH')}{$weixin.shareimg}"><input type="hidden" name="Weixin[shareimg]" value="{$weixin.shareimg}" /></a>
                                                            </div>
                                                        </li>
                                                    </notempty>
                                                    <li class="upImg-lighthouse">
                                                        <div class="upImg-list-box">
                                                            <div class="filePic">
                                                                <i class="am-icon-cloud-upload"></i><div class="txt">上传图片</div>
                                                                <input type="file" pname="Weixin[shareimg]" link="{:U('Upload/upSharePic')}" class="upInput" value="选择凭证图片" name="file" max="5" maxsize="5120" allowexts="gif,jpeg,jpg,png,bmp" accept="image/*" multiple>
                                                            </div>
                                                            
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                            <small>图片尺寸：正方形图片</small>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <div class="am-u-sm-9 am-u-sm-push-3">
                                            <input type="hidden" name="info[id]" value="{$info.id}" />
                                            <input type="submit" name="" value="提交" class="am-btn am-btn-primary tpl-btn-bg-color-success submitBtn">
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
<style type="text/css">
    .input-txt-lin .on-txt,.input-txt-lin input{ float: left!important;}
    .input-txt-lin .on-txt{ line-height: 35px;}
    .input-txt-lin input{ width: 50px!important; margin: 0 5px; text-align: center;}
</style>
<include file="Common:footer_link" />
<js href="--PUBLIC--/PhotoClipJs/lrz.all.bundle.js"/>
<script type="text/javascript">
    // 表单提交
        var $form = $('#rechargeableForm');
        var $subbtn = $(".submitBtn");
        $form.validator({
            submit: function() {
                var formValidity = this.isFormValid();
                if (formValidity) {
                    // 验证成功的逻辑
                    $subbtn.button('loading');
                    // 验证成功的逻辑
                    $form.ajaxSubmit({url:document.URL,data:'',type:"POST",
                        success:function(data, st) {
                            // 提示框
                            AMUI.dialog.alert({ title: data.title, content: data.info});
                            if(data.status==1){
                                setTimeout(function(){
                                    top.window.location.href = data.url;
                                },1000);
                            }else{
                                $subbtn.button('reset');
                            }
                            return false;
                        }
                    });
                } else {
                    $subbtn.button('reset');
                // 验证失败的逻辑
                }
            //阻止原生form提交
            return false;
            }
        });
</script>
</body>
</html>
